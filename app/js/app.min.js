var app=angular.module("tcesp-angular-app.core",["ngRoute","tcesp-angular-app.directives","tcesp-angular-app.services","tcesp-angular-app.controllers"]);app.config(["$routeProvider",function(e){e.when("/users",{templateUrl:"views/users.html",controller:"UsersListCtrl"}),e.when("/users/:userId",{templateUrl:"views/users_detail.html",controller:"UsersDetailCtrl"}),e.when("/despesas",{templateUrl:"views/despesas.html",controller:"DespesasMunicipiosCtrl"}),e.when("/despesas/:municipioId",{templateUrl:"views/despesas_detail.html",controller:"DespesasMunicipiosDetailCtrl"}),e.when("/despesas/:municipioId/:orgaoId",{templateUrl:"views/despesas_orgaos.html",controller:"DespesasOrgaosCtrl"}),e.when("/despesas/:municipioId/:orgaoId/:ano",{templateUrl:"views/despesas_orgaos.html",controller:"DespesasOrgaosCtrl"}),e.when("/orgaos",{templateUrl:"views/orgaos_list.html",controller:"OrgaosListCtrl"})}]);var services=angular.module("tcesp-angular-app.services",["tcesp-angular-app.services.users","tcesp-angular-app.services.despesas","tcesp-angular-app.services.orgaos"]),controllers=angular.module("tcesp-angular-app.controllers",["tcesp-angular-app.controllers.users","tcesp-angular-app.controllers.despesas","tcesp-angular-app.controllers.orgaos"]),directives=angular.module("tcesp-angular-app.directives",["tcesp-angular-app.directives.despesas"]),API_URL="http://localhost:5000/api",DespesasSvc=angular.module("tcesp-angular-app.services.despesas",["ngResource"]);DespesasSvc.factory("Despesas",["$resource",function(e){return e(API_URL+"/despesas/:municipioId/:orgaoId/:ano/:tipoDespesa",{},{list:{method:"GET",isArray:!0}})}]);var DespesasCtrl=angular.module("tcesp-angular-app.controllers.despesas",[]);DespesasCtrl.controller("DespesasMunicipiosCtrl",["$scope","Despesas",function(e,s){e.despesas=s.list()}]),DespesasCtrl.controller("DespesasMunicipiosDetailCtrl",["$scope","$routeParams","Despesas",function(e,s,a){e.despesas=a.list({municipioId:s.municipioId})}]),DespesasCtrl.controller("DespesasOrgaosCtrl",["$scope","$routeParams","Despesas",function(e,s,a){function r(e){return e=e.split(/[.,]/).join("")/100,e=Math.round(100*e/Math.pow(10,6))/100}e.anos=[2014,2013,2012,2011,2010,2009,2008],e.meses=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],e.ano=s.ano||(new Date).getUTCFullYear(),e.chartSeries=[{name:"Empenhado",data:[]},{name:"Liquidado",data:[]},{name:"Pago",data:[]}],e.despesas=a.list({municipioId:s.municipioId,orgaoId:s.orgaoId,ano:e.ano},function(){var s=[[],[],[]];e.despesas.forEach(function(e){s[0].push(r(e.vl_empenhado)),s[1].push(r(e.vl_liquidado)),s[2].push(r(e.vl_pago))}),e.chartSeries[0].data=s[0],e.chartSeries[1].data=s[1],e.chartSeries[2].data=s[2]}),e.ideas=[["ideas1",1],["ideas2",8],["ideas3",5]]}]);var DespesasDtv=angular.module("tcesp-angular-app.directives.despesas",[]);DespesasDtv.directive("hcPie",function(){return{restrict:"C",replace:!0,scope:{items:"="},controller:function(){console.log(2)},template:'<div id="containerChart" style="margin: 0 auto">not working</div>',link:function(e){console.log(3);var s=new Highcharts.Chart({chart:{renderTo:"containerChart",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:"Browser market shares at a specific website, 2010"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage}%</b>",percentageDecimals:1},plotOptions:{pie:{animation:!0,allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<b>"+this.point.name+"</b>: "+this.percentage+" %"}}}},series:[{type:"pie",name:"Browser share",data:e.items}]},function(e){$("#addPoint").click(function(){e.series[0].addPoint(1)})});e.$watch("items",function(e){s.series[0].setData(e,!0)},!0)}}}),DespesasDtv.directive("hcStacked",function(){return{restrict:"C",replace:!0,scope:{items:"=",title:"="},controller:function(){console.log(2)},template:'<div id="containerChart1" style="margin: 0 auto">not working</div>',link:function(e){console.log(3);var s={chart:{type:"column",renderTo:"containerChart1",animation:!0},title:{text:"Despesas - NOME DO ORGAO, ANO"},xAxis:{categories:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},yAxis:{min:0,title:{text:"em milhÃµes de R$"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}}},tooltip:{pointFormat:"{point.y:.2f} MM"},plotOptions:{column:{stacking:"normal"}},series:e.items},a=new Highcharts.Chart(s);e.$watch("items",function(e){console.log(e),e&&e.forEach(function(s,r){a.series[r].setData(e[r].data,!0)})},!0)}}});var API_URL="http://localhost:5000/api",OrgaosSvc=angular.module("tcesp-angular-app.services.orgaos",["ngResource"]);OrgaosSvc.factory("Orgaos",["$resource",function(e){return e(API_URL+"/orgaos",{},{list:{method:"GET",isArray:!0}})}]);var OrgaosCtrl=angular.module("tcesp-angular-app.controllers.orgaos",[]);OrgaosCtrl.controller("OrgaosListCtrl",["$scope","$window","Orgaos",function(e,s,a){function r(){var e=JSON.parse(s.localStorage.getItem("orgaos")),a=new Date;return e&&new Date(e.expirationDate)>a?e.data:""}function t(){var a=new Date;a.setDate(a.getDate()+30);var r={expirationDate:a,data:e.orgaos};s.localStorage.setItem("orgaos",JSON.stringify(r))}e.orgaos=r()||a.list(t)}]);var API_URL="http://localhost:5000/api",UsersSvc=angular.module("tcesp-angular-app.services.users",["ngResource"]);UsersSvc.factory("Users",["$resource",function(e){return e(API_URL+"/users/:userId",{},{list:{method:"GET",isArray:!0},update:{method:"PUT"}})}]);var UsersCtrl=angular.module("tcesp-angular-app.controllers.users",[]);UsersCtrl.controller("UsersListCtrl",["$scope","Users",function(e,s){e.users=s.list()}]),UsersCtrl.controller("UsersDetailCtrl",["$scope","$routeParams","Users",function(e,s,a){e.user=a.get({userId:s.userId}),e.form={},e.form.status="",e.editUser=function(){a.update({userId:s.userId},{user:e.user},function(){e.form.status="OK"},function(){e.form.status="REQUEST_ERROR"})}}]);